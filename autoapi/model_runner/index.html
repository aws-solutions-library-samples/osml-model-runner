

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>model_runner &mdash; OversightML Model Runner  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="model_runner.api" href="api/index.html" />
    <link rel="prev" title="API Reference" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            OversightML Model Runner
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">model_runner</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/index.html">model_runner.api</a></li>
<li class="toctree-l4"><a class="reference internal" href="app_config/index.html">model_runner.app_config</a></li>
<li class="toctree-l4"><a class="reference internal" href="common/index.html">model_runner.common</a></li>
<li class="toctree-l4"><a class="reference internal" href="database/index.html">model_runner.database</a></li>
<li class="toctree-l4"><a class="reference internal" href="exceptions/index.html">model_runner.exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_request_handler/index.html">model_runner.image_request_handler</a></li>
<li class="toctree-l4"><a class="reference internal" href="inference/index.html">model_runner.inference</a></li>
<li class="toctree-l4"><a class="reference internal" href="model_runner/index.html">model_runner.model_runner</a></li>
<li class="toctree-l4"><a class="reference internal" href="queue/index.html">model_runner.queue</a></li>
<li class="toctree-l4"><a class="reference internal" href="region_request_handler/index.html">model_runner.region_request_handler</a></li>
<li class="toctree-l4"><a class="reference internal" href="sink/index.html">model_runner.sink</a></li>
<li class="toctree-l4"><a class="reference internal" href="status/index.html">model_runner.status</a></li>
<li class="toctree-l4"><a class="reference internal" href="tile_worker/index.html">model_runner.tile_worker</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#model_runner.ModelRunner"><code class="docutils literal notranslate"><span class="pre">ModelRunner</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">OversightML Model Runner</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">API Reference</a></li>
      <li class="breadcrumb-item active">model_runner</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/autoapi/model_runner/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-model_runner">
<span id="model-runner"></span><h1>model_runner<a class="headerlink" href="#module-model_runner" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">model_runner.api</a></li>
<li class="toctree-l1"><a class="reference internal" href="app_config/index.html">model_runner.app_config</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/index.html">model_runner.common</a></li>
<li class="toctree-l1"><a class="reference internal" href="database/index.html">model_runner.database</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions/index.html">model_runner.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_request_handler/index.html">model_runner.image_request_handler</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference/index.html">model_runner.inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_runner/index.html">model_runner.model_runner</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue/index.html">model_runner.queue</a></li>
<li class="toctree-l1"><a class="reference internal" href="region_request_handler/index.html">model_runner.region_request_handler</a></li>
<li class="toctree-l1"><a class="reference internal" href="sink/index.html">model_runner.sink</a></li>
<li class="toctree-l1"><a class="reference internal" href="status/index.html">model_runner.status</a></li>
<li class="toctree-l1"><a class="reference internal" href="tile_worker/index.html">model_runner.tile_worker</a></li>
</ul>
</div>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model_runner.ModelRunner" title="model_runner.ModelRunner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModelRunner</span></code></a></p></td>
<td><p>Main class for operating the ModelRunner application. It monitors input queues for processing requests,</p></td>
</tr>
</tbody>
</table>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model_runner.ModelRunner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model_runner.</span></span><span class="sig-name descname"><span class="pre">ModelRunner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiling_strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="tile_worker/index.html#model_runner.tile_worker.TilingStrategy" title="model_runner.tile_worker.TilingStrategy"><span class="pre">model_runner.tile_worker.TilingStrategy</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">VariableOverlapTilingStrategy()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model_runner.ModelRunner" title="Link to this definition"></a></dt>
<dd><p>Main class for operating the ModelRunner application. It monitors input queues for processing requests,
decomposes the image into smaller regions and tiles, invokes an ML model on each tile, and aggregates
the results into a single output, which can be sent to the configured output sinks.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#model_runner.ModelRunner.config" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.tiling_strategy">
<span class="sig-name descname"><span class="pre">tiling_strategy</span></span><a class="headerlink" href="#model_runner.ModelRunner.tiling_strategy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.image_request_queue">
<span class="sig-name descname"><span class="pre">image_request_queue</span></span><a class="headerlink" href="#model_runner.ModelRunner.image_request_queue" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.image_requests_iter">
<span class="sig-name descname"><span class="pre">image_requests_iter</span></span><a class="headerlink" href="#model_runner.ModelRunner.image_requests_iter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.region_request_queue">
<span class="sig-name descname"><span class="pre">region_request_queue</span></span><a class="headerlink" href="#model_runner.ModelRunner.region_request_queue" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.region_requests_iter">
<span class="sig-name descname"><span class="pre">region_requests_iter</span></span><a class="headerlink" href="#model_runner.ModelRunner.region_requests_iter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.job_table">
<span class="sig-name descname"><span class="pre">job_table</span></span><a class="headerlink" href="#model_runner.ModelRunner.job_table" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.region_request_table">
<span class="sig-name descname"><span class="pre">region_request_table</span></span><a class="headerlink" href="#model_runner.ModelRunner.region_request_table" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.endpoint_statistics_table">
<span class="sig-name descname"><span class="pre">endpoint_statistics_table</span></span><a class="headerlink" href="#model_runner.ModelRunner.endpoint_statistics_table" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.image_status_monitor">
<span class="sig-name descname"><span class="pre">image_status_monitor</span></span><a class="headerlink" href="#model_runner.ModelRunner.image_status_monitor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.region_status_monitor">
<span class="sig-name descname"><span class="pre">region_status_monitor</span></span><a class="headerlink" href="#model_runner.ModelRunner.region_status_monitor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.endpoint_utils">
<span class="sig-name descname"><span class="pre">endpoint_utils</span></span><a class="headerlink" href="#model_runner.ModelRunner.endpoint_utils" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.region_request_handler">
<span class="sig-name descname"><span class="pre">region_request_handler</span></span><a class="headerlink" href="#model_runner.ModelRunner.region_request_handler" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.image_request_handler">
<span class="sig-name descname"><span class="pre">image_request_handler</span></span><a class="headerlink" href="#model_runner.ModelRunner.image_request_handler" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model_runner.ModelRunner.running">
<span class="sig-name descname"><span class="pre">running</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#model_runner.ModelRunner.running" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model_runner.ModelRunner.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#model_runner.ModelRunner.run" title="Link to this definition"></a></dt>
<dd><p>Start the ModelRunner to continuously monitor and process work queues.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model_runner.ModelRunner.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#model_runner.ModelRunner.stop" title="Link to this definition"></a></dt>
<dd><p>Stop the ModelRunner.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model_runner.ModelRunner.monitor_work_queues">
<span class="sig-name descname"><span class="pre">monitor_work_queues</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#model_runner.ModelRunner.monitor_work_queues" title="Link to this definition"></a></dt>
<dd><p>Continuously monitors the SQS queues for RegionRequest and ImageRequest.
:return: None</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model_runner.ModelRunner._process_region_requests">
<span class="sig-name descname"><span class="pre">_process_region_requests</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="headerlink" href="#model_runner.ModelRunner._process_region_requests" title="Link to this definition"></a></dt>
<dd><p>Process messages from the region request queue.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if a region request was processed, False if not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model_runner.ModelRunner._process_image_requests">
<span class="sig-name descname"><span class="pre">_process_image_requests</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="headerlink" href="#model_runner.ModelRunner._process_image_requests" title="Link to this definition"></a></dt>
<dd><p>Processes messages from the image request queue.</p>
<p>This method retrieves and processes image requests from the SQS queue. It validates
the image request, and if valid, passes it to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageRequestHandler</span></code> for further
processing. In case of a retryable exception, the request is reset in the queue with
a visibility timeout. If the image request fails due to an error, it is marked as
failed and the appropriate actions are taken.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="../../_apidoc/aws.osml.model_runner.api.exceptions.html#aws.osml.model_runner.api.exceptions.InvalidImageRequestException" title="aws.osml.model_runner.api.exceptions.InvalidImageRequestException"><strong>InvalidImageRequestException</strong></a> – If the image request is found to be invalid.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a> – If an unexpected error occurs during processing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if a image request was processed, False if not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model_runner.ModelRunner._fail_image_request">
<span class="sig-name descname"><span class="pre">_fail_image_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_request</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="api/index.html#model_runner.api.ImageRequest" title="model_runner.api.ImageRequest"><span class="pre">model_runner.api.ImageRequest</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><span class="pre">Exception</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#model_runner.ModelRunner._fail_image_request" title="Link to this definition"></a></dt>
<dd><p>Handles failing an image request by updating its status and logging the failure.</p>
<p>This method is called when an image request cannot be processed due to an error.
It marks the image request as failed and updates the job status using the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageRequestHandler</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_request</strong> – The image request that failed to process.</p></li>
<li><p><strong>error</strong> – The exception that caused the failure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model_runner.ModelRunner._get_or_create_region_request_item">
<span class="sig-name descname"><span class="pre">_get_or_create_region_request_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region_request</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="api/index.html#model_runner.api.RegionRequest" title="model_runner.api.RegionRequest"><span class="pre">model_runner.api.RegionRequest</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="database/index.html#model_runner.database.RegionRequestItem" title="model_runner.database.RegionRequestItem"><span class="pre">model_runner.database.RegionRequestItem</span></a></span></span><a class="headerlink" href="#model_runner.ModelRunner._get_or_create_region_request_item" title="Link to this definition"></a></dt>
<dd><p>Retrieves or creates a <code class="xref py py-obj docutils literal notranslate"><span class="pre">RegionRequestItem</span></code> in the region request table.</p>
<p>This method checks if a region request already exists in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">RegionRequestTable</span></code>.
If it does, it retrieves the existing request; otherwise, it creates a new
<code class="xref py py-obj docutils literal notranslate"><span class="pre">RegionRequestItem</span></code> from the provided <code class="xref py py-obj docutils literal notranslate"><span class="pre">RegionRequest</span></code> and starts the region
processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>region_request</strong> – The region request to process.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The retrieved or newly created <code class="xref py py-obj docutils literal notranslate"><span class="pre">RegionRequestItem</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api/index.html" class="btn btn-neutral float-right" title="model_runner.api" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Amazon.com.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    .wy-nav-content { max-width: none; }
</style>



</body>
</html>